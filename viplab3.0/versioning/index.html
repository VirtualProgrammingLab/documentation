<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>JSON Object Versioning Rules - ViPLab</title>
        <link href="../../css/bootstrap.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css">

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="../..">ViPLab</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href="../.." class="nav-link">Welcome to the Viplab documentation</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Ecs2 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../ecs2/" class="dropdown-item">Core ECS</a>
</li>
                                    
<li>
    <a href="../../ecs2/example/" class="dropdown-item">Beispiele</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Rest <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../rest/" class="dropdown-item">ECS REST Interface</a>
</li>
                                    
<li>
    <a href="../../rest/auths/" class="dropdown-item">Auths</a>
</li>
                                    
<li>
    <a href="../../rest/econtent/" class="dropdown-item">Econtent</a>
</li>
                                    
<li>
    <a href="../../rest/eventqueues/" class="dropdown-item">Eventqueues</a>
</li>
                                    
<li>
    <a href="../../rest/memberships/" class="dropdown-item">memberships</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Viplab <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../../viplab/" class="dropdown-item">Index</a>
</li>
                                    
<li>
    <a href="../../viplab/exercises/" class="dropdown-item">/numlab/exercises</a>
</li>
                                    
<li>
    <a href="../../viplab/interrupts/" class="dropdown-item">Interrupts</a>
</li>
                                    
<li>
    <a href="../../viplab/results/" class="dropdown-item">/numlab/results</a>
</li>
                                    
<li>
    <a href="../../viplab/solutions/" class="dropdown-item">/numlab/solutions</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown active">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Viplab3.0 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../" class="dropdown-item">Index</a>
</li>
                                    
<li>
    <a href="../computation/" class="dropdown-item">Computation JSON Message</a>
</li>
                                    
<li>
    <a href="../computation_result/" class="dropdown-item">Computation Result JSON Message</a>
</li>
                                    
<li>
    <a href="../computation_task/" class="dropdown-item">Computation Task JSON Message</a>
</li>
                                    
<li>
    <a href="../computation_template/" class="dropdown-item">Computation Template JSON Message</a>
</li>
                                    
<li>
    <a href="../system_status/" class="dropdown-item">System status JSON message</a>
</li>
                                    
<li>
    <a href="./" class="dropdown-item active">JSON Object Versioning Rules</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                        <li class="nav-item">
                            <a href="#" class="nav-link" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li class="nav-item">
                                <a rel="prev" href="../system_status/" class="nav-link">
                                    <i class="fa fa-arrow-left"></i> Previous
                                </a>
                            </li>
                            <li class="nav-item">
                                <a rel="next" class="nav-link disabled">
                                    Next <i class="fa fa-arrow-right"></i>
                                </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#json-object-versioning-rules" class="nav-link">JSON Object Versioning Rules</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#context-and-problem-statement" class="nav-link">Context and Problem Statement</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#decision-drivers" class="nav-link">Decision Drivers</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#considered-options" class="nav-link">Considered Options</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#decision-outcome" class="nav-link">Decision Outcome</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#pros-and-cons-of-the-options" class="nav-link">Pros and Cons of the Options</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#links" class="nav-link">Links</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<h1 id="json-object-versioning-rules">JSON Object Versioning Rules</h1>
<ul>
<li>Status: proposed</li>
<li>Deciders: Leon Kiefer, Per Pascal Seeland</li>
<li>Date: 2020-05-14</li>
</ul>
<p>Technical Story: https://github.com/VirtualProgrammingLab/documentation/issues/1</p>
<h2 id="context-and-problem-statement">Context and Problem Statement</h2>
<p>The ViPLab Projects defines a set of JSON-objects, which are used in the different components of the project. Since ViPLab itself does not 
store any data, these objects have to be stored by third party systems. These will be, depending on the context they are used in either LMS (like ILIAS)
or data repositories (like dataverse). There needs to be a way to identify the version of the different objects stored by the third party system to 
allow e.g. upgrading/migrating the different components. </p>
<h2 id="decision-drivers">Decision Drivers</h2>
<ul>
<li>Provide a way to identify the version of the objects and also provide a path for e.g. upgrading the API endpoints used by those systems.</li>
</ul>
<h2 id="considered-options">Considered Options</h2>
<ul>
<li>Version all endpoints, but not the objects</li>
<li>Version all objects, but not the endpoints</li>
<li>Version parts of the objects and all of the endpoints.</li>
<li>Version all objects and all of the endpoints.</li>
</ul>
<h2 id="decision-outcome">Decision Outcome</h2>
<p>It has been decided to version all long living objects, and all endpoints. The reason for requiring all objects to have version tags is for consistency
reasons. Endpoints will only accept objects versions of one major version. Breaking changes will require to define a new version. Incremental 
updates, which only extend the object are allowed. All systems are expected to handle these incremental updates gracefully. This means that a
version 3.1.x message returned by the api must be accept by a 3.0.x client. The additional information contained by the api may be discarded. The same
rules apply when a 3.1.x client talks to a 3.0.x api. The api will process the message according to the 3.0.x rules and extra information might be discarded.</p>
<p>The client has to determine the correct endpoint versions to use. When the client will use a ComputationTemplate with version 3.x.x the corresponding
websocket api will be ws://example.com/v3/computation. All other messages used in any further communication between the websocket-api and the client
are also expected to be version 3.x.x. There is no possiblity to mix different versions. If a client wants to use a v4 api, he has to reconnect to the correct
endpoint at ws://example.com/v4/computation</p>
<p>The objects have been devided into three groups:
- Long living object: ComputationTemplate, ComputationTask and ComputationResult
- Wrappers: Computation
- Message Types: CreateComputation and Result</p>
<p>All long living objects are expected to be stored by clients and have version attribute on their top level of the json object, making it easy to get the information. Wrappers only exist during the communication between the client and the api and thus will not contain any version information, as it can be derived from the version of the api version they are being used with. Their only functionality is to group long living objects during a request. Messages Types are the messages used for the communication of the client with the websocket api. Like the wrappers they belong to a specific endpoint version and are also not versioned.</p>
<h3 id="positive-consequences">Positive Consequences</h3>
<p>Providing version information allows api and the client to be updated independently. It also allows the objects being held by the client to be easily identified without the need to either store this information somewhere external, where is might get lost or require some method to identify it based on the attributes available.</p>
<h3 id="negative-consequences">Negative Consequences</h3>
<p>The version needs to stored on all objects, which requires additional space and bandwidth. Also this information needs to be processed in the endpoints. But this in neglactable considered to the need of upgrading different systems of different third party users at once.</p>
<h2 id="pros-and-cons-of-the-options">Pros and Cons of the Options</h2>
<p>Versioning either only the endpoints would still cause the issue, that a client needs to keep track of which implicit version an object has, to make sure he picks
the right endpoint. This might also lead to the fact, that one might try to send the data to the wrong endpoint, since it is not known where it should belong.
Only versioning the endpoints would require to add a lot of version identification cold on the api side, which should be avoided.</p>
<p>Between the last to options, the only difference is, that the actions wrappers are not being versioned. This tradeoff has been made due to the fact, that they should never be stored somewhere and that they are considered stable for one api version. Adding actions or changing the wrappers itself will cause a upgrade of the api version.</p>
<h2 id="links">Links</h2></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="searchModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="searchModalLabel">Search</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
                <p>From here you can search these documents. Enter your search terms below.</p>
                <form>
                    <div class="form-group">
                        <input type="search" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results" data-no-results-text="No results found"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
